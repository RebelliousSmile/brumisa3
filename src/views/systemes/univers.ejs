<%
// Configuration dynamique basée sur l'univers et le système
// theme et universeIcon sont maintenant passés par le contrôleur
// Protection contre les valeurs undefined
const safeTheme = theme || { classes: { text: 'text-gray-400', border: 'border-gray-500', bg: 'bg-gray-600/20' } };
const safeUniverseIcon = universeIcon || 'ra-dice';

// Déterminer les couleurs du système
const systemColors = {
    pbta: { gradient: 'from-purple-900 via-purple-800 to-black', primary: 'bg-purple-600 hover:bg-purple-700', secondary: 'border-purple-400 text-purple-400 hover:bg-purple-400' },
    engrenages: { gradient: 'from-amber-900 via-amber-800 to-black', primary: 'bg-amber-700 hover:bg-amber-800', secondary: 'border-amber-600 text-amber-600 hover:bg-amber-600' },
    myz: { gradient: 'from-red-900 via-red-800 to-black', primary: 'bg-red-600 hover:bg-red-700', secondary: 'border-red-400 text-red-400 hover:bg-red-400' },
    mistengine: { gradient: 'from-pink-900 via-pink-800 to-black', primary: 'bg-pink-600 hover:bg-pink-700', secondary: 'border-pink-400 text-pink-400 hover:bg-pink-400' },
    zombiology: { gradient: 'from-yellow-900 via-yellow-800 to-black', primary: 'bg-yellow-600 hover:bg-yellow-700', secondary: 'border-yellow-400 text-yellow-400 hover:bg-yellow-400' }
};
const currentSystemColors = systemColors[systeme] || { gradient: 'from-gray-900 via-gray-800 to-black', primary: 'bg-blue-600 hover:bg-blue-700', secondary: 'border-gray-400 text-gray-400 hover:bg-gray-400' };

const configUniversGeneric = {
    hero: {
        gradient: currentSystemColors.gradient,
        icone: safeUniverseIcon,
        couleurIcone: safeTheme.classes.text,
        titre: configUnivers.nom,
        description: configUnivers.description,
        couleurTexte: 'text-gray-200',
        couleurBoutonPrimaire: currentSystemColors.primary,
        couleurBoutonSecondaire: currentSystemColors.secondary + ' hover:text-gray-900',
        texteBoutonPrimaire: 'Créer un personnage',
        texteBoutonSecondaire: 'Voir les oracles',
        systemTheme: safeTheme,
        gameSystem: systeme
    },
    commentCreer: {
        nomSysteme: configUnivers.nom,
        couleurBordure: safeTheme.classes.border,
        couleurFond: safeTheme.classes.bg.replace('/20', ''),
        couleurIcone: safeTheme.classes.text,
        texteEtape1: `Parcourez notre collection de templates pour ${configUnivers.nom} et sélectionnez celui qui correspond à vos besoins.`,
        texteEtape2: 'Utilisez notre éditeur intuitif pour remplir les champs, ajuster les valeurs et personnaliser votre aide de jeu.',
        texteEtape3: 'Cliquez sur "Générer" pour créer un PDF professionnel prêt à imprimer ou à partager avec votre table.'
    },
    oracles: {
        nomSysteme: configUnivers.nom,
        couleurBordure: safeTheme.classes.border.replace('/30', '/30'),
        couleurIcone: safeTheme.classes.text,
        couleurBouton: safeTheme.classes.bg.replace('/20', '') + ' hover:' + safeTheme.classes.bg.replace('/20', '-700'),
        lienOracles: `/oracles/systeme/${systeme}`,
        descriptionOracles: `Les oracles sont des outils essentiels pour enrichir vos parties dans l'univers de ${configUnivers.nom}. Ces tables aléatoires vous aident à générer des événements, des complications et des éléments narratifs de manière improvisée.`,
        oracles: [
            {
                icone: 'ra ra-crystal-ball',
                nom: 'Événements',
                description: 'Événements aléatoires pour vos parties'
            },
            {
                icone: 'ra ra-player',
                nom: 'PNJ',
                description: 'Personnages non-joueurs à improviser'
            },
            {
                icone: 'ra ra-location',
                nom: 'Lieux',
                description: 'Endroits mystérieux à découvrir'
            }
        ]
    },
    downloads: {
        nomSysteme: configUnivers.nom,
        couleurBordure: safeTheme.classes.border.replace('/30', '/20'),
        couleurHover: safeTheme.classes.text.replace('text-', '').replace('-400', '-400'),
        couleurBouton: safeTheme.classes.bg.replace('/20', '') + ' hover:' + safeTheme.classes.bg.replace('/20', '-700'),
        couleurBordureSecondaire: safeTheme.classes.border.replace('/30', '') + ' ' + safeTheme.classes.text + ' hover:' + safeTheme.classes.bg.replace('/20', '') + ' hover:text-white',
        downloads: [
            {
                titre: 'Aide-mémoire MJ',
                description: 'Référence rapide des règles principales',
                auteur: 'la Communauté',
                telechargements: '1.2k',
                typeBadge: safeTheme.classes.bg.replace('/20', ''),
                typeLabel: 'PDF'
            },
            {
                titre: 'Tables d\'Événements',
                description: '100 événements pour enrichir vos parties',
                auteur: 'MJ_Anonyme',
                telechargements: '890',
                typeBadge: safeTheme.classes.bg.replace('/20', ''),
                typeLabel: 'PDF'
            }
        ]
    },
    cta: {
        gradient: currentSystemColors.gradient,
        titreCTA: `Prêt à explorer l'univers de ${configUnivers.nom} ?`,
        descriptionCTA: 'Rejoignez notre communauté et commencez à créer des histoires inoubliables.',
        couleurTexte: 'text-gray-100',
        couleurTexteBouton: currentSystemColors.primary,
        couleurTexteBoutonSecondaire: currentSystemColors.secondary
    }
};
%>

<%- include('../partials/systeme-hero', Object.assign({}, configUniversGeneric.hero, { systemTheme: safeTheme, gameSystem: systeme })) %>

<%- include('../partials/systeme-comment-creer', Object.assign({}, configUniversGeneric.commentCreer, { systemTheme: safeTheme, gameSystem: systeme })) %>

<!-- Templates Section -->
<div class="bg-gray-800 py-16 px-4">
    <div class="max-w-7xl mx-auto">
        <h2 class="text-3xl font-bold text-center mb-12 text-white">
            Documents Disponibles
        </h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-1 gap-8 max-w-2xl mx-auto">
            <!-- Document Générique -->
            <div class="bg-gray-900 p-6 rounded-lg border <%= safeTheme.classes.border %> hover:border-<%= safeTheme.classes.text.replace('text-', '').replace('-400', '-400') %> transition-colors group">
                <div class="text-center mb-4">
                    <i class="ra ra-scroll text-5xl <%= safeTheme.classes.text %> group-hover:text-<%= safeTheme.classes.text.replace('text-', '').replace('-400', '-300') %> transition-colors"></i>
                </div>
                <h3 class="text-xl font-semibold mb-3 <%= safeTheme.classes.text %> text-center">Document Générique</h3>
                <p class="text-gray-300 mb-4 text-center">Template polyvalent pour créer tous types de documents pour <%= configUnivers.nom %> avec un style adapté à l'univers.</p>
                
                <div class="mb-6">
                    <h4 class="text-sm font-semibold text-white mb-2">Inclus :</h4>
                    <ul class="text-sm text-gray-400 space-y-1">
                        <li>• Mise en page élégante adaptée à l'univers</li>
                        <li>• Polices thématiques</li>
                        <li>• Marges généreuses (2,5 cm)</li>
                        <li>• Hiérarchie typographique à 3 niveaux</li>
                        <li>• Encadrés pour informations importantes</li>
                        <li>• Export PDF haute qualité</li>
                    </ul>
                </div>
                
                <div class="flex flex-col gap-2">
                    <a href="/systeme/<%= systeme %>/<%= univers %>/document-generique" class="w-full <%= safeTheme.classes.bg.replace('/20', '') %> hover:<%= safeTheme.classes.bg.replace('/20', '-700') %> text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors text-center">
                        Créer un document
                    </a>
                    <button class="w-full border <%= safeTheme.classes.border %> <%= safeTheme.classes.text %> hover:<%= safeTheme.classes.bg.replace('/20', '') %> hover:text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors">
                        Voir un exemple
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/systeme-oracles', Object.assign({}, configUniversGeneric.oracles, { systemTheme: safeTheme, gameSystem: systeme })) %>

<%- include('../partials/systeme-downloads', Object.assign({}, configUniversGeneric.downloads, { systemTheme: safeTheme, gameSystem: systeme })) %>

<%- include('../partials/systeme-cta', Object.assign({}, configUniversGeneric.cta, { systemTheme: safeTheme, gameSystem: systeme })) %>