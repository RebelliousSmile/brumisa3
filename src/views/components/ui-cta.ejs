<%
/*
 * Composant CTA (Call to Action) Universel v1.0 - Avec Support Thèmes Système
 * Usage: <%- include('components/ui-cta', { 
 *   title: 'Rejoignez l\'aventure !',
 *   subtitle: 'Créez vos personnages et vivez des histoires épiques',
 *   backgroundType: 'gradient|solid|image',
 *   backgroundImage: '/images/cta-bg.jpg',
 *   gameSystem: 'monsterhearts',
 *   buttons: [
 *     { text: 'Commencer', href: '/signup', variant: 'primary', size: 'lg' },
 *     { text: 'En savoir plus', href: '/about', variant: 'outline', size: 'lg' }
 *   ],
 *   centered: true,
 *   padding: 'py-16',
 *   customClass: ''
 * }) %>
 */

// Paramètres avec valeurs par défaut
const {
    title = 'Titre par défaut',
    subtitle = '',
    backgroundType = 'gradient',
    backgroundImage = '',
    gameSystem = '',
    buttons = [],
    centered = true,
    padding = 'py-16',
    customClass = ''
} = locals;

// Intégration du SystemThemeService côté serveur
const SystemThemeService = require('../../services/SystemThemeService');
const systemTheme = gameSystem ? SystemThemeService.getTheme(gameSystem) : null;

// Classes de fond par type
const getBackgroundClasses = (type, systemTheme) => {
    if (type === 'image' && backgroundImage) {
        return 'bg-cover bg-center bg-no-repeat';
    }
    
    if (type === 'solid') {
        if (systemTheme) {
            const systemColorMap = {
                monsterhearts: 'bg-purple-900',
                engrenages: 'bg-emerald-900',
                metro2033: 'bg-red-900',
                mistengine: 'bg-pink-900',
                zombiology: 'bg-yellow-900'
            };
            return systemColorMap[gameSystem] || 'bg-gray-900';
        }
        return 'bg-gray-900';
    }
    
    // Gradient par défaut ou thématique
    if (systemTheme) {
        const systemGradientMap = {
            monsterhearts: 'bg-gradient-to-br from-purple-900 via-purple-800 to-gray-900',
            engrenages: 'bg-gradient-to-br from-emerald-900 via-emerald-800 to-gray-900',
            metro2033: 'bg-gradient-to-br from-red-900 via-red-800 to-gray-900',
            mistengine: 'bg-gradient-to-br from-pink-900 via-pink-800 to-gray-900',
            zombiology: 'bg-gradient-to-br from-yellow-900 via-yellow-800 to-gray-900'
        };
        return systemGradientMap[gameSystem] || 'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900';
    }
    
    return 'bg-gradient-to-br from-generique via-blue-800 to-gray-900';
};

const backgroundClasses = getBackgroundClasses(backgroundType, systemTheme);

// Classes finales pour la section
const sectionClasses = [
    'relative overflow-hidden text-white',
    backgroundClasses,
    padding,
    customClass
].filter(Boolean).join(' ');

// Classes pour le contenu
const contentClasses = centered ? 'text-center' : 'text-left';
%>

<!-- CTA Section Universelle -->
<section class="<%= sectionClasses %>" <% if (backgroundType === 'image' && backgroundImage) { %>style="background-image: url('<%= backgroundImage %>')"<% } %>>
    <!-- Overlay pour les images de fond -->
    <% if (backgroundType === 'image' && backgroundImage) { %>
        <div class="absolute inset-0 bg-black bg-opacity-60"></div>
    <% } %>
    
    <!-- Contenu -->
    <div class="relative z-10 max-w-4xl mx-auto px-4">
        <div class="<%= contentClasses %>">
            <!-- Titre -->
            <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-6 text-white">
                <%= title %>
            </h2>
            
            <!-- Sous-titre -->
            <% if (subtitle) { %>
                <p class="text-xl md:text-2xl mb-8 text-gray-200 max-w-2xl <%= centered ? 'mx-auto' : '' %>">
                    <%= subtitle %>
                </p>
            <% } %>
            
            <!-- Boutons -->
            <% if (buttons && buttons.length > 0) { %>
                <div class="flex flex-col sm:flex-row gap-4 <%= centered ? 'justify-center' : 'justify-start' %>">
                    <% buttons.forEach(button => { %>
                        <%- include('ui-button', {
                            text: button.text,
                            href: button.href,
                            action: button.action,
                            variant: button.variant || 'primary',
                            size: button.size || 'lg',
                            icon: button.icon,
                            gameSystem: gameSystem,
                            additionalClasses: 'font-semibold ' + (button.additionalClasses || '')
                        }) %>
                    <% }); %>
                </div>
            <% } %>
        </div>
    </div>
</section>